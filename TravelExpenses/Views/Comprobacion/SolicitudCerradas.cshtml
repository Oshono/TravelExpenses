@model TravelExpenses.ViewModels.ObservacionViewModel

@{
    ViewData["Title"] = "Centro de Costos";
    Layout = "/Pages/Shared/_Layout.cshtml";
}
<h2>Aprobar Solicitud</h2>

<div class="col-12 grid-margin stretch-card">
    <div class="card">

        <div class="card-body">
            <div class="col-4">
                <select asp-for="Estatus.IdEstatus" class="form-control input-sm" id="estatus" onchange="ObtenerSolcitudes()"
                        asp-items="@(new SelectList(Model.Estatuses, "IdEstatus", "Status"))">
                    <option value="">--Seleccionar estatus</option>
                    <option value="">Todos</option>
                </select>
            </div>
            <br/>
            <div class="row">
                <div class="col-2">
                    Fecha Inicio
                    <input type="date" class="form-control" id="inicio" name="inicio" />
                </div>
                <div class="col-2">
                    Fecha Fin
                    <input type="date" class="form-control" id="fin" name="fin" />
                </div>
                <div class="col-2">
                    <br />
                    <input type="button" class="btn btn-primary" value="Buscar" onclick='ObtenerSolcitudesFechas();' />
                </div>
                @*<div class="col-sm-2">
            <br />
            <button type="button" id="boton_enviar" onclick='fnExcelReport();'
                    class="btn btn-primary">
                <span class="glyphicon glyphicon-ok"></span> Exportar opcion 1
            </button>
        </div>*@
                <form method="post" asp-controller="Comprobacion" asp-action="OnPostExport" enctype="multipart/form-data">
                    <div class="col-sm-2 ">
                        <br />
                        <input type="hidden" asp-for=@Model.Array class="form-control" id="Array" name="Array" />
                        <input type="submit" onclick='ReiniciarPagina();' value="Exportar" class="btn btn-primary" />
                    </div>
                </form>
            </div>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-striped" id="tabla2">
                    <thead>
                        <tr>
                            <th>Selecionar</th>
                            <th>Folio</th>
                            <th>Tipo Solicitud</th>
                            <th>Solicitante</th>
                            <th>Cantidad Solicitada</th>
                            <th>Cantidad Comprobada</th>
                            <th>Estatus</th>
                            <th>Editar</th>
                        </tr>
                    </thead>
                    <tbody id="tblSolicitud">
                    @foreach (var item in Model.Solicitudes)
                    {
                        <tr>
                            <td><input type="checkbox" id="SOLICITIDCHECK" name="SOLICITIDCHECK" onclick="SelecionarSolicitudes()"/></td>
                            <td>@item.Folio</td>
                            <td>@item.Descripcion</td>
                            <td>@item.UserName</td>
                            <td style="display: none">@item.ImporteSolicitado</td>
                            <td style="display: none">@item.FechaSolicitud </td>
                            <td>@string.Format("{0:C}", item.ImporteSolicitado)</td>
                            <td>@string.Format("{0:C}", item.ImporteComprobado) </td>
                            <td>@item.Estatus</td>

                            <td>
                                @if (item.Estatus.Equals("Cerrada"))
                                {
                                    <a class="btn btn-lg" asp-controller="Comprobacion" asp-action="DetallesSolicitudCerradas" asp-route-folio="@item.Folio">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                }
                            </td>
                        </tr>
                    }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<iframe id="txtArea1" style="display:none"></iframe>
<script src="~/lib/jquery/dist/jquery.js"></script>
<script src="~/lib/isaias_jasso.js"></script>
